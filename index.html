<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bouncing Balls</title>
    <style>
    	* { padding: 0; margin: 0; }
    	canvas { background: #eee; display: block; margin: 0 auto; }
    </style>
</head>
<body>
    <canvas id="myCanvas" width="800px" height="600px"></canvas>

<script>

//start variation declaration//
var canvas = document.getElementById("myCanvas");
var ctx = canvas.getContext("2d");
var ballRadius = 10;

var xLeft = [canvas.width/2, canvas.width/4, canvas.width/6, canvas.width/8, canvas.width/10,
         canvas.width/5, canvas.width/12, canvas.width/15, canvas.width, canvas.width/20];
var yTop = [canvas.height-30, canvas.height -50, canvas.height -100, canvas.height - 120, 
         canvas.height - 150, canvas.height -90, canvas.height -100, canvas.height-40,
         canvas.height - 80, canvas.height- 75];
var xyVelocity = [2, 4,2,5,7,5,9,3,6,2,-2, -5, -3, -4, -5, -6, -3, -2, -1, -7];
/* var color = ['#00FFFF', '#006400', '#4B0082', '#C71585', '#E9967A',
                '#7B68EE', '#191970','#FF0000', '#00FF7F', '#FFFF00']; */
var total = 5;
var totalBalls = [];
var ymouse = 0;
var xmouse = 0;
var Y = [];
var X = [];
var xx = [];
var yy = [];  
var xClick = 0;
var yClick = 0;   
//End variables declaration//


function getColor() {
    return ("#" + Math.floor(Math.random()*16777215).toString(16).padStart(6, '0').toUpperCase()); 
}

function getLeft() {
    return xLeft[Math.floor(Math.random() * xLeft.length)];
}

function getTop() {
    return yTop[Math.floor(Math.random() * yTop.length)];
}

function getVelocity() {
    return xyVelocity[Math.floor(Math.random() * xyVelocity.length)];
}

//check left and top to keep ball inside the canvase //
function checkWalls(i) {
  if (totalBalls[i].x <= 0 ) {
    totalBalls[i].x = totalBalls[i].ballRadius;        
  } else if(totalBalls[i].x >= canvas.width){
    totalBalls[i].x = canvas.width - totalBalls[i].ballRadius;        
  }

  if (totalBalls[i].y <= 0) {
    totalBalls[i].y = totalBalls[i].ballRadius; 
  }else if(totalBalls[i].y >= canvas.height){
    totalBalls[i].y = canvas.height - totalBalls[i].ballRadius; 
  }
}

function mouse(e){
    ymouse = e.clientY;
    xmouse = e.clientX;
    followMouse();
}
function mouseClick(e){
    yClick = e.clientY;
    xClick = e.clientX;
    makeBall();
}

function makeBall() {
    let xValue, yValue ;
    if(xClick == 0 && yClick == 0){
        xValue = getLeft();
        yValue = getTop();
    } else {
        xValue = xClick;
        yValue = yClick;
        xClick = 0;
        yClick = 0;
    }

    let ball = {
        "x": xValue,
        "y": yValue,
        "color": getColor(),
        "dx": getVelocity(),
        "dy": getVelocity(),
        "ballRadius": ballRadius
    };
    
    totalBalls.push(ball);   //Adding new ball into array//

    //initialize array using later for following mouse//    
    xx[totalBalls.length] = X[totalBalls.length] = canvas.width/2 ;
    yy[totalBalls.length] = Y[totalBalls.length] = canvas.height/2 ;
}

function followMouse() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    // first drags second and we all follow the mouse
    yy[0] = ymouse - 50;
    xx[0] = xmouse - 50;
    totalBalls[0].x = xx[0];
    totalBalls[0].y = yy[0];

    for (let i = totalBalls.length - 1; i > 0; --i) {
         yy[i] = Y[i] += (yy[i - 1] - Y[i]) * 0.2;   //speed = 0.2//
        xx[i] = X[i] += (xx[i - 1] - X[i]) * 0.2; 
        //adding new positions//
        totalBalls[i].x = xx[i] ;
        totalBalls[i].y = yy[i] ;
        drawBall(i);       
    }  
    drawBall[0];     
}

function drawBall(num) { 
    ctx.beginPath();
    ctx.arc(totalBalls[num].x, totalBalls[num].y, totalBalls[num].ballRadius, 0, Math.PI*2, false);
    ctx.fillStyle = totalBalls[num].color;
    ctx.fill();
    ctx.closePath();
}

//This function sets new position to all balls//
function draw() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);

        if (totalBalls.length == 0) {
            total = total;
        }else{
            total = totalBalls.length;
        }

        for (let i = 0; i < total; i++) {
            //total is 15 for now.//

            if (totalBalls.length < total)  makeBall();   //add one ball into totalBalls array// 
                
            drawBall(i);      //draw ball on canvase//

            checkWalls(i);    //check new position is inside the canvase//

            //set new directions//
            if((totalBalls[i].x + totalBalls[i].dx > canvas.width-ballRadius) || 
                (totalBalls[i].x + totalBalls[i].dx < ballRadius)) {
                totalBalls[i].dx = -totalBalls[i].dx;
            }
            if((totalBalls[i].y + totalBalls[i].dy > canvas.height-ballRadius) || 
                (totalBalls[i].y + totalBalls[i].dy < ballRadius)) {
                totalBalls[i].dy = -totalBalls[i].dy;
            }            
            
            //set new positions//
            totalBalls[i].x += totalBalls[i].dx;
            totalBalls[i].y += totalBalls[i].dy;
            
        }   
    ////
    setTimeout(draw, 50);
}

//canvas.addEventListener("mousemove", mouse, false);
if (window.addEventListener) {
  window.addEventListener("load", draw, false);
  document.addEventListener("mousemove", mouse, false)
  document.addEventListener("mousedown", mouseClick, false);
} 
else if (window.attachEvent) {
  window.attachEvent("onload", draw);
  document.attachEvent("onmousemove", mouse); 
  document.addEventListener("onmousedown", mouseClick, false);
}

</script>
</body>
</html>